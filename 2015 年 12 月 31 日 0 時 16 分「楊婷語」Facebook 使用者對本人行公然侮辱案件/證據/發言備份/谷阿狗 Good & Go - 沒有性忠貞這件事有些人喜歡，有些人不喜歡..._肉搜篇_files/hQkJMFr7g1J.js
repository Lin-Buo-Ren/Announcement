/*!CK:2841640087!*//*1451489666,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["YxZyK"]); }

__d('AllActivityContentLoader',['Arbiter','CSS','DOM','DOMScroll','OnVisible','Parent','MorePagerFetchOnScroll','TimelineComponentKeys','TimelineConstants','TimelineController','TimelineLegacySections','TimelineSmartInsert','UIPagelet','Vector','$','clickRefAction','csx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){if(c.__markCompiled)c.__markCompiled();var y=false,z=0,aa=null,ba={},ca=[],da={},ea=[],fa=null;function ga(ka,la,ma,na,oa){this.node=ka;this._canScrollLoad=true;this.scrubberKey=la;this._pageletLoadData=ma;this.loaded=na;this.sortKey=oa;this.contentNode=j.scry(ka,"div._z6j")[0];}function ha(){if(y)return;q.register(o.CONTENT,ja);w('scrubber').set_namespace('allactivity');y=true;}function ia(ka){var la=r.get(ka);la&&la._canScrollLoad&&la.load();}Object.assign(ga.prototype,{load:function(){if(this.loaded)return;this.loaded=true;this.contentNode&&i.hide(this.contentNode);i.show(m.byClass(this.node,'fbTimelineSection'));var ka=this.node;function la(na){s.run(ka,na);}var ma=j.find(this.node,'div.fbTimelineLogStream');ea.push(t.loadFromEndpoint('TimelineEntStoryActivityLogPagelet',ma.id,this._pageletLoadData,{usePipe:true,jsNonblock:true,constHeight:true,displayCallback:la,append:true}));},contentAdded:function(ka){if(!this.hasContent){i.removeClass(m.byClass(this.node,'stat_elem'),'async_saving');if(this.contentNode){ka&&j.prependContent(this.contentNode,ka);i.show(this.contentNode);}this.hasContent=true;}},fullyLoaded:function(){if(!this.hasContent){i.removeClass(m.byClass(this.node,'stat_elem'),'async_saving');i.show(j.find(this.node,"div._40pu"));this.contentNode&&i.hide(this.contentNode);}},activateScrollLoad:function(){this._canScrollLoad=true;da[this.scrubberKey]&&da[this.scrubberKey].reset();},deactivateScrollLoad:function(){if(!this.loaded){this._canScrollLoad=false;}else{var ka=j.scry(this.node,'.uiMorePager');if(ka)ka.map(function(la){var ma=n.getInstance(la.id);ma&&ma.removeEventListeners();});}da[this.scrubberKey]&&da[this.scrubberKey].remove();},getParent:function(){if(this.parentKey)return r.get(this.parentKey);return null;}});var ja={SCROLL_TO_OFFSET:115,HEADER_SCROLL_CUTOFF:30,CURRENT_SECTION_OFFSET:150,registerTimePeriod:function(ka,la,ma,na,oa,pa){ha();var qa=new ga(ka,la,ma,na,pa);if(!oa){ca.push(la);ba[la]=true;}else{qa.parentKey=oa;r.get(oa).subSections=r.get(oa).subSections||[];r.get(oa).subSections.push(qa);r.get(oa).subSections.sort(function(ra,sa){return sa.sortKey-ra.sortKey;});}r.set(la,qa);ja.checkCurrentSectionChange();h.inform(p.SECTION_REGISTERED,{scrubberKey:la},h.BEHAVIOR_PERSISTENT);},reset:function(){ja.stopLoadingContent();y=false;r.removeAll();z=0;aa=null;ba={};ca=[];da={};ea=[];fa=null;},stopLoadingContent:function(){for(var ka in da)da[ka]&&da[ka].remove();for(var la=0;la<ea.length;la++)ea[la].cancel();},setContentHeader:function(ka){fa=ka;},checkCurrentSectionChange:function(){var ka=ja.getCurrentSection(),la=aa&&aa.scrubberKey;if(ka&&ka.scrubberKey!==la){aa=ka;var ma=ka.scrubberKey,na=ka.parentKey;if(!na){na=ma;ma=null;}q.sectionHasChanged(na,ma);}},getCurrentSection:function(){var ka={},la=r.getAll();for(var ma in la){var na=la[ma];if(!na.loaded)continue;var oa=u.getElementPosition(na.node,'viewport').y;if(oa<ja.CURRENT_SECTION_OFFSET)ka[oa]=na;}var pa=Math.max.apply(this,Object.keys(ka)),qa=pa==-Infinity;if(!qa){return ka[pa];}else return null;},enableScrollLoad:function(ka,la,ma){ka=v(ka);var na=ja.getNextSectionKey(la);if(na)da[na]=new l(ka,ia.bind(null,na),false,ma||1000);},getNextSectionKey:function(ka){var la=r.get(ka),ma=la.getParent(),na=null,oa=null;if(ma)for(var pa=0;pa<ma.subSections.length-1;pa++)if(ma.subSections[pa].scrubberKey==ka)na=ma.subSections[pa+1].scrubberKey;if(!na)for(var qa=0;qa<ca.length-qa;qa++)if(ca[qa]==ma.scrubberKey){oa=r.get(ca[qa+1]).subSections[0];if(oa)na=oa.scrubberKey;}return na;},navigateToSection:function(ka,la,ma){la=!!la;var na=r.get(ka);if(!na)return;if(!na.getParent()){ka=na.subSections[0].scrubberKey;na=r.get(ka);}for(var oa=0;oa<ca.length;oa++){var pa=r.get(ca[oa]);for(var qa=0;qa<pa.subSections.length;qa++){if(pa.subSections[qa].scrubberKey==ka)break;pa.subSections[qa].deactivateScrollLoad();}if(pa.scrubberKey==na.getParent().scrubberKey)break;}na.activateScrollLoad();na.load();ja.adjustContentPadding();var ra=u.getScrollPosition().x,sa=u.getElementPosition(na.node).y;if(!la){var ta=ja.SCROLL_TO_OFFSET;k.scrollTo(new u(ra,sa-ta,'document'));}},adjustContentPadding:function(){v('fbTimelineLogBody').style.paddingBottom=u.getViewportDimensions().y-ja.CURRENT_SECTION_OFFSET-ja.HEADER_SCROLL_CUTOFF+'px';},sectionHasContent:function(ka){var la=r.get(ka);la&&la.contentAdded(fa);fa=null;},sectionFullyLoaded:function(ka){var la=r.get(ka);la&&la.fullyLoaded();}};f.exports=ja;},null);
__d('ActivityLogSearch',['Event','CSS','DOM','Input','Run'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();function m(n,o,p){var q=j.find(p,'.inputtext'),r=h.listen(o,'click',function(){i.hide(n);i.show(p);q.focus();});l.onLeave(r.remove.bind(r));var s=h.listen(q,'blur',function(){if(!k.getValue(q)){i.hide(p);i.show(n);}});l.onLeave(s.remove.bind(s));}f.exports=m;},null);
__d('PopoverMenuDynamicTooltip',['DOMQuery','Tooltip','csx'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();function k(l){'use strict';this._popoverMenu=l;this._setMenuSubscription=null;this._changeSubscription=null;}k.prototype.enable=function(){'use strict';this._setMenuSubscription=this._popoverMenu.subscribe('setMenu',this._onSetMenu.bind(this));};k.prototype.disable=function(){'use strict';this._popoverMenu.unsubscribe(this._setMenuSubscription);this._setMenuSubscription=null;this._removeChangeSubscription();};k.prototype._onSetMenu=function(){'use strict';this._removeChangeSubscription();this._menu=this._popoverMenu.getMenu();this._changeSubscription=this._menu.subscribe('change',(function(l,m){var n=m.item;if(m[0])n=m[0].item;if(!n)return;var o=n.getLabel();o=o?o.toString():null;if(!o)return;var p=this._popoverMenu.getTriggerElem(),q=h.scry(p,"span._55pe")[0];if(q&&q.nodeName){var r=q.parentNode;if(r)i.set(r,o);}}).bind(this));};k.prototype._removeChangeSubscription=function(){'use strict';if(this._changeSubscription){this._menu.unsubscribe(this._changeSubscription);this._changeSubscription=null;}};f.exports=k;},null);
__d('ScrollHighlight',['DOMScroll','highlight'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j={actOn:function(k,l,m){h.scrollTo(k,true,false,false,m);i(k,null,l);}};f.exports=j;},null);
__d('ProfileApprovalController',['AsyncRequest','DOM','Event','HTML','$','ge'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();function n(o){'use strict';this.queueType=o;var p=m('profileApprovalSeeMoreLink');if(p)j.listen(p,'click',this.clickedSeeMore.bind(this));}n.prototype.getNewStories=function(){'use strict';var o=this.getStoryData(),p={filter:this.FILTER_NEWER,filter_timestamp:o.newest_time,filter_fbid:o.newest_fbid};new h().setURI('/ajax/profile/approval/get_more.php').setData(p).setHandler(this.handleContent).send();};n.prototype.clickedSeeMore=function(){'use strict';var o=this.getStoryData(),p={queue_type:this.queueType,filter:this.FILTER_OLDER,filter_timestamp:o.oldest_time,filter_fbid:o.oldest_fbid};new h().setURI('/ajax/profile/approval/get_more.php').setData(p).setHandler(this.handleContent).send();};n.prototype.handleContent=function(o){'use strict';var p=o.payload;if(p.pager_error){i.replace(l('profileApprovalSeeMoreContainer'),k(p.pager_markup));return;}if(p.hide_more_pager)i.remove(l('profileApprovalSeeMoreContainer'));if(!p.items_markup)return;if(p.insert_before)i.prependContent(i.find(l('profileApprovalContentContainer'),'.profileApprovalList'),k(p.items_markup));if(p.insert_after)i.appendContent(i.find(l('profileApprovalContentContainer'),'.profileApprovalList'),k(p.items_markup));};n.prototype.getStoryData=function(){'use strict';var o=i.scry(l('profileApprovalContentContainer'),'.profileApprovalStoryContainer');if(!o)return;var p=o[0],q=o[o.length-1];return {newest_time:p.getAttribute('data-timestamp'),newest_fbid:p.getAttribute('data-fbid'),oldest_time:q.getAttribute('data-timestamp'),oldest_fbid:q.getAttribute('data-fbid')};};n.NO_MORE_CONTENT='no_more_content';Object.assign(n.prototype,{FILTER_NONE:0,FILTER_OLDER:1,FILTER_NEWER:2});f.exports=n;},null);
__d('legacy:profile-approval-controller',['ProfileApprovalController'],function a(b,c,d,e){if(c.__markCompiled)c.__markCompiled();b.ProfileApprovalController=c('ProfileApprovalController');},3);
__d('TimelineAllActivitySideNav',['$','CSS','DOMQuery','FutureSideNav','PageTransitions','Scroll','Style','UIPagelet','csx','ge','getOrCreateDOMID','getViewportDimensions'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){if(c.__markCompiled)c.__markCompiled();function t(v){var w=v==='review'||v==='tagreview',x=q('rightColContent'),y=x&&j.scry(x,".fbTimelineLogScrubber")[0];y&&i.conditionShow(y,!w);}var u={init:function(v,w,x,y,z){var aa=j.find(h('contentArea'),"._6-0"),ba=r(aa);n.set(aa,'minHeight',s().height+'px');i.addClass(v,'fixed_elem');t(z||'all');l.registerHandler(function(ca){if(w===ca.getPath()&&ca.getQueryData().sk==x){var da=babelHelpers._extends({profile_id:y,renderContentsOnly:1,uripath:ca.toString()},ca.getQueryData()),ea=k.getInstance(),fa=ea&&ea._getItemForKey(da.log_filter||'all');fa&&ea.setLoading(fa);o.loadFromEndpoint('TimelineAllActivityColumn',ba,da,{jsNonblock:true,constHeight:true,displayCallback:function(ga){ga();fa&&ea.setSelected(fa);m.setTop(document.body,0);t(da.log_filter||'all');l.transitionComplete(true);}});return true;}return false;});}};f.exports=u;},null);
__d('ApprovalQueueCountUpdater',['Arbiter','DOM','NavigationMessage','ge'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l={updateCounts:function(m,n,o){var p=m.friends+m.others,q=k('tag_count_friends'),r=k('tag_count_other');h.inform(j.NAVIGATION_COUNT_UPDATE,{key:'review',count:p<=o?p:o,hide:true});if(q)i.setContent(q,m.friends<=n?m.friends:n+'+');if(r)i.setContent(r,m.others<=n?m.others:n+'+');}};f.exports=l;},null);